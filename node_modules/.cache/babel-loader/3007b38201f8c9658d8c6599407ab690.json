{"ast":null,"code":"import { all, takeLatest, call, put } from 'redux-saga/effects';\nimport axios from 'axios';\nimport { signInSuccess, signInFailure, signOutSuccess, signOutFailure, signUpSuccess, signUpFailure } from '../actions/userActions';\n\nfunction signInApi(username, password) {\n  return axios({\n    method: \"POST\",\n    data: {\n      username,\n      password\n    },\n    withCredentials: true,\n    url: \"http://localhost:4000/login\"\n  }).then(res => {\n    return res.data;\n  }).catch(err => {\n    throw new Error(\"Password or username is incorrect.\");\n  });\n}\n\nfunction signInApiclient(username, password) {\n  return axios({\n    method: \"POST\",\n    data: {\n      username,\n      password\n    },\n    withCredentials: true,\n    url: \"http://localhost:4000/loginclient\"\n  }).then(res => {\n    return res.data;\n  }).catch(err => {\n    throw new Error(\"Password or username is incorrect.\");\n  });\n}\n\nfunction signUpApi(username, password) {\n  return axios({\n    method: \"POST\",\n    data: {\n      username,\n      password\n    },\n    withCredentials: true,\n    url: \"http://localhost:4000/register\"\n  }).then(res => {\n    return res.data.user;\n  }).catch(err => {\n    const {\n      message\n    } = err.response.data;\n    throw new Error(message);\n  });\n}\n\nfunction getCurrentUser() {\n  return axios({\n    method: \"GET\",\n    withCredentials: true,\n    url: \"http://localhost:4000/user\"\n  }).then(res => {\n    return res.data;\n  }).catch(err => {\n    throw new Error(\"Not logged in\");\n  });\n}\n\nfunction getCurrentUserr() {\n  return axios({\n    method: \"GET\",\n    withCredentials: true,\n    url: \"http://localhost:4000/userr\"\n  }).then(res => {\n    return res.data;\n  }).catch(err => {\n    throw new Error(\"Not logged in\");\n  });\n}\n\nfunction signOutApi() {\n  return axios({\n    method: \"GET\",\n    withCredentials: true,\n    url: \"http://localhost:4000/logout\"\n  }).then(res => {\n    console.log(res);\n    return res.data;\n  }).catch(err => {\n    throw new Error(\"Cannot logged out.\");\n  });\n}\n\nexport function* signIn({\n  payload: {\n    username,\n    password\n  }\n}) {\n  try {\n    const user = yield call(signInApi, username, password);\n    yield put(signInSuccess(user));\n  } catch (err) {\n    yield put(signInFailure(err.message));\n  }\n}\nexport function* signInclient({\n  payload: {\n    username,\n    password\n  }\n}) {\n  try {\n    const client = yield call(signInApiclient, username, password);\n    yield put(signInSuccess(client));\n  } catch (err) {\n    yield put(signInFailure(err.message));\n  }\n}\nexport function* signUp({\n  payload: {\n    username,\n    password\n  }\n}) {\n  try {\n    const user = yield call(signUpApi, username, password);\n    yield put(signUpSuccess(user));\n  } catch (err) {\n    yield put(signUpFailure(err.message));\n  }\n}\nexport function* isUserLoggedIn() {\n  const user = yield call(getCurrentUser);\n\n  if (user) {\n    yield put(signInSuccess(user));\n  } else {\n    return;\n  }\n}\nexport function* isUserLoggedInclient() {\n  const client = yield call(getCurrentUserr);\n\n  if (client) {\n    yield put(signInSuccess(client));\n  } else {\n    return;\n  }\n}\nexport function* signOut() {\n  try {\n    const successMsg = yield call(signOutApi);\n    console.log(successMsg);\n    yield put(signOutSuccess(successMsg));\n  } catch (err) {\n    yield put(signOutFailure(err.message));\n  }\n}\nexport function* onSignInStart() {\n  yield takeLatest('SIGN_IN_START', signIn);\n}\nexport function* onSignUpStart() {\n  yield takeLatest('SIGN_UP_START', signUp);\n}\nexport function* onCheckUserSession() {\n  yield takeLatest('CHECK_USER_SESSION', isUserLoggedIn);\n}\nexport function* onSignOutStart() {\n  yield takeLatest('SIGN_OUT_START', signOut);\n}\nexport function* userSagas() {\n  yield all([call(onSignInStart), call(onSignUpStart), call(onCheckUserSession), call(onSignOutStart)]);\n}","map":{"version":3,"sources":["C:/Users/14382/Desktop/DECInfodeGestion/S5/PROGRAMMATION AVEC FRAMEWORK CÔTÉ CLIENT/ReactEscapeRoom_SoufianeJD/frontend/src/components/redux/sagas/userSagas.js"],"names":["all","takeLatest","call","put","axios","signInSuccess","signInFailure","signOutSuccess","signOutFailure","signUpSuccess","signUpFailure","signInApi","username","password","method","data","withCredentials","url","then","res","catch","err","Error","signInApiclient","signUpApi","user","message","response","getCurrentUser","getCurrentUserr","signOutApi","console","log","signIn","payload","signInclient","client","signUp","isUserLoggedIn","isUserLoggedInclient","signOut","successMsg","onSignInStart","onSignUpStart","onCheckUserSession","onSignOutStart","userSagas"],"mappings":"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","sourcesContent":["import { all, takeLatest, call, put } from 'redux-saga/effects';\nimport axios from 'axios';\n\nimport {\n\tsignInSuccess,\n\tsignInFailure,\n\tsignOutSuccess,\n\tsignOutFailure,\n\tsignUpSuccess,\n\tsignUpFailure\n\t\n} from '../actions/userActions';\n\nfunction signInApi(username, password) {\n\treturn axios({\n\t\tmethod: \"POST\",\n\t\tdata: {\n\t\t\tusername,\n\t\t\tpassword\n\t\t},\n\t\twithCredentials: true,\n\t\turl: \"http://localhost:4000/login\",\n\t\t})\n\t\t.then(res => {\n\t\t\treturn res.data\n\t\t})\n\t\t.catch(err => {\n\t\t\tthrow new Error(\"Password or username is incorrect.\");\n\t\t});\n}\n\nfunction signInApiclient(username, password) {\n\treturn axios({\n\t\tmethod: \"POST\",\n\t\tdata: {\n\t\t\tusername,\n\t\t\tpassword\n\t\t},\n\t\twithCredentials: true,\n\t\turl: \"http://localhost:4000/loginclient\",\n\t\t})\n\t\t.then(res => {\n\t\t\treturn res.data\n\t\t})\n\t\t.catch(err => {\n\t\t\tthrow new Error(\"Password or username is incorrect.\");\n\t\t});\n}\n\nfunction signUpApi(username, password) {\n\treturn axios({\n\t\tmethod: \"POST\",\n\t\tdata: {\n\t\t\tusername,\n\t\t\tpassword\n\t\t},\n\t\twithCredentials: true,\n\t\turl: \"http://localhost:4000/register\",\n\t})\n\t\t.then(res => {\n\t\t\treturn res.data.user\n\t\t})\n\t\t.catch(err => {\n\t\t\tconst { message } = err.response.data;\n\t\t\tthrow new Error(message);\n\t\t});\n}\n\n\n\nfunction getCurrentUser() {\n\treturn axios({\n\t\tmethod: \"GET\",\n\t\twithCredentials: true,\n\t\turl: \"http://localhost:4000/user\"\n\t\t})\n\t\t.then(res => {\n\t\t\treturn res.data\n\t\t})\n\t\t.catch(err => {\n\t\t\tthrow new Error(\"Not logged in\");\n\t\t});\n}\n\n\nfunction getCurrentUserr() {\n\treturn axios({\n\t\tmethod: \"GET\",\n\t\twithCredentials: true,\n\t\turl: \"http://localhost:4000/userr\"\n\t\t})\n\t\t.then(res => {\n\t\t\treturn res.data\n\t\t})\n\t\t.catch(err => {\n\t\t\tthrow new Error(\"Not logged in\");\n\t\t});\n}\n\nfunction signOutApi() {\n\treturn \taxios({\n\t\t\t\tmethod: \"GET\",\n\t\t\t\twithCredentials: true,\n\t\t\t\turl: \"http://localhost:4000/logout\"\n\t\t\t})\n\t\t\t.then(res => {\n\t\t\t\tconsole.log(res);\n\t\t\t\treturn res.data\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tthrow new Error(\"Cannot logged out.\");\n\t\t\t});\n}\n\nexport function* signIn({payload: {username, password}}) {\n\ttry {\n\t\tconst user = yield call(signInApi, username, password);\n\t\tyield put(signInSuccess(user));\n\t} catch(err) {\n\t\tyield put(signInFailure(err.message));\n\t}\n}\n\nexport function* signInclient({payload: {username, password}}) {\n\ttry {\n\t\tconst client = yield call(signInApiclient, username, password);\n\t\tyield put(signInSuccess(client));\n\t} catch(err) {\n\t\tyield put(signInFailure(err.message));\n\t}\n}\n\nexport function* signUp({payload: {username, password}}) {\n\ttry {\n\t\tconst user = yield call(signUpApi, username, password);\n\t\tyield put(signUpSuccess(user));\n\t} catch(err) {\n\t\tyield put(signUpFailure(err.message));\n\t}\n}\n\nexport function* isUserLoggedIn() {\n\tconst user = yield call(getCurrentUser);\n\tif (user) {\n\t\tyield put(signInSuccess(user));\n\t} else {\n\t\treturn;\n\t}\n}\n\nexport function* isUserLoggedInclient() {\n\tconst client = yield call(getCurrentUserr);\n\tif (client) {\n\t\tyield put(signInSuccess(client));\n\t} else {\n\t\treturn;\n\t}\n}\n\n\n\nexport function* signOut() {\n\ttry {\n\t\tconst successMsg = yield call(signOutApi);\n\t\tconsole.log(successMsg);\n\t\tyield put(signOutSuccess(successMsg));\n\t} catch(err) {\n\t\tyield put(signOutFailure(err.message));\n\t}\n}\n\nexport function* onSignInStart() {\n\tyield takeLatest('SIGN_IN_START', signIn)\n}\n\nexport function* onSignUpStart() {\n\tyield takeLatest('SIGN_UP_START', signUp)\n}\n\nexport function* onCheckUserSession() {\n\tyield takeLatest('CHECK_USER_SESSION', isUserLoggedIn)\n}\n\n\nexport function* onSignOutStart() {\n\tyield takeLatest('SIGN_OUT_START', signOut)\n}\nexport function* userSagas() {\n\tyield all([\n\t\tcall(onSignInStart),\n\t\tcall(onSignUpStart),\n\t\tcall(onCheckUserSession),\n\t\tcall(onSignOutStart)\n\t])\n}"]},"metadata":{},"sourceType":"module"}